# ===================================
# 獨立開發環境配置（不依賴其他服務）
# Usage: docker compose -f docker-compose.standalone.yml up
# ===================================

services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
      target: development
    container_name: autobooks-api-dev
    restart: unless-stopped
    ports:
      - "${API_PORT:-8000}:8000"  # 本地可用 .env 設定,CI/CD 用預設 8000
    env_file:
      - .env
    environment:
      - DJANGO_DEBUG=True
      - DJANGO_SECRET_KEY=${DJANGO_SECRET_KEY}
      - DJANGO_ALLOWED_HOSTS=${DJANGO_ALLOWED_HOSTS:-localhost,127.0.0.1}
      - DATABASE_ENGINE=sqlite
      - CORS_ALLOWED_ORIGINS=${CORS_ALLOWED_ORIGINS:-http://localhost:3000}
    volumes:
      - ./api:/app:cached
      - api_static:/app/staticfiles
      - api_media:/app/media
    command: python manage.py runserver 0.0.0.0:8000

volumes:
  api_static:
  api_media: